{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _regeneratorRuntime from\"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _templateObject;import axios from\"axios\";import{useContext,useState}from\"react\";import{useHistory}from\"react-router-dom\";import styled from\"styled-components\";import MetaContext from\"../../MetaContext\";import{Login}from\"../HomePage/LoginLogout\";import LoadingScreen from\"../OSCEPage/LoadingScreen\";import heart from\"../OSCEPage/media/heart.png\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Chekout=function Chekout(props){var _useContext=useContext(MetaContext),SERVER_URL=_useContext.SERVER_URL,CLIENT_URL=_useContext.CLIENT_URL,token=_useContext.token;var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),handlingCheckout=_useState2[0],updateHandlingCheckout=_useState2[1];var handleCheckout=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(t){var purchasedOsce,checkoutUrl;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:updateHandlingCheckout(true);_context.prev=1;_context.next=4;return axios.post(SERVER_URL+\"/user/osce_details\",{token:t});case 4:purchasedOsce=_context.sent.data.purchasedOsce;if(!purchasedOsce){_context.next=7;break;}return _context.abrupt(\"return\",history.push(\"/OSCE\"));case 7:_context.next=9;return axios.post(SERVER_URL+\"/pay/create-checkout-session\",{cancel_url:CLIENT_URL+\"/Subscribe/PaymentCanceled\",success_url:CLIENT_URL+\"/Subscribe/PaymentSuccess\",token:t});case 9:checkoutUrl=_context.sent.data;window.location.href=checkoutUrl;_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](1);console.log(_context.t0);case 16:updateHandlingCheckout(false);case 17:case\"end\":return _context.stop();}}},_callee,null,[[1,13]]);}));return function handleCheckout(_x){return _ref.apply(this,arguments);};}();return handlingCheckout?/*#__PURE__*/_jsx(LoadingScreen,{message:\"Please wait\"}):/*#__PURE__*/_jsxs(\"div\",{style:{background:\"#2f3237\",margin:\"5%\",padding:\"5%\",textAlign:\"center\"},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",margin:\"20px auto\",justifyContent:\"center\",alignItems:\"center\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{margin:\"10px\"},children:/*#__PURE__*/_jsx(\"img\",{src:heart,height:100})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"25px\"},children:\" Unlock Premium Stations \"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:\"15px\"},children:\" Only \\xA345 per year \"})]})]}),token?/*#__PURE__*/_jsx(CheckoutButton,{color:\"#FAD000\",minWidth:300,onClick:function onClick(){return handleCheckout(token);},children:\"Unlock the greatness\"}):/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return updateHandlingCheckout(true);},children:/*#__PURE__*/_jsx(Login,{label:\"Unlock the greatness\",successCallback:function successCallback(t){return handleCheckout(t);}})})]});};export default Chekout;var CheckoutButton=styled.button(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    display: block;\\n    margin: auto;\\n    border-style: none;\\n    border: 2px solid \",\";\\n    background-color: transparent;\\n    color: \",\";\\n    border-radius: 5px;\\n    padding: 5px;\\n    min-width: \",\"px;\\n    &:hover {\\n        background-color: \",\";\\n        color: black;\\n    }\\n\"])),function(props){return props.color;},function(props){return props.color;},function(props){return props.minWidth;},function(props){return props.color;});","map":{"version":3,"sources":["/Users/albert/projects/med-bakery-react/client/src/components/SubscribePage/Checkout.tsx"],"names":["axios","useContext","useState","useHistory","styled","MetaContext","Login","LoadingScreen","heart","Chekout","props","SERVER_URL","CLIENT_URL","token","history","handlingCheckout","updateHandlingCheckout","handleCheckout","t","post","purchasedOsce","data","push","cancel_url","success_url","checkoutUrl","window","location","href","console","log","background","margin","padding","textAlign","display","justifyContent","alignItems","fontSize","CheckoutButton","button","color","minWidth"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport { useContext, useState } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport MetaContext from \"../../MetaContext\";\nimport { Login } from \"../HomePage/LoginLogout\";\nimport { Box } from \"../OSCEPage/Common\";\nimport LoadingScreen from \"../OSCEPage/LoadingScreen\";\nimport heart from \"../OSCEPage/media/heart.png\";\n\ntype ChekoutProps = {};\n\nconst Chekout = (props: ChekoutProps) => {\n    const { SERVER_URL, CLIENT_URL, token } = useContext(MetaContext);\n    const history = useHistory();\n    const [handlingCheckout, updateHandlingCheckout] = useState(false);\n\n    const handleCheckout = async (t: string) => {\n        updateHandlingCheckout(true);\n        try {\n            const { purchasedOsce } = (\n                await axios.post(SERVER_URL + \"/user/osce_details\", { token: t })\n            ).data;\n\n            if (purchasedOsce) return history.push(\"/OSCE\");\n\n            const checkoutUrl = (\n                await axios.post(SERVER_URL + \"/pay/create-checkout-session\", {\n                    cancel_url: CLIENT_URL + \"/Subscribe/PaymentCanceled\",\n                    success_url: CLIENT_URL + \"/Subscribe/PaymentSuccess\",\n                    token: t,\n                })\n            ).data;\n\n            window.location.href = checkoutUrl;\n        } catch (err) {\n            console.log(err);\n        }\n        updateHandlingCheckout(false);\n    };\n\n    return handlingCheckout ? (\n        <LoadingScreen message=\"Please wait\" />\n    ) : (\n        <div style={{ background: \"#2f3237\", margin: \"5%\", padding: \"5%\", textAlign: \"center\" }}>\n            <div\n                style={{\n                    display: \"flex\",\n                    margin: \"20px auto\",\n                    justifyContent: \"center\",\n                    alignItems: \"center\",\n                }}\n            >\n                <div style={{ margin: \"10px\" }}>\n                    <img src={heart} height={100} />\n                </div>\n                <div>\n                    <div style={{ fontSize: \"25px\" }}> Unlock Premium Stations </div>\n                    <div style={{ fontSize: \"15px\" }}> Only Â£45 per year </div>\n                </div>\n            </div>\n\n            {token ? (\n                <CheckoutButton\n                    color=\"#FAD000\"\n                    minWidth={300}\n                    onClick={() => handleCheckout(token)}\n                >\n                    Unlock the greatness\n                </CheckoutButton>\n            ) : (\n                <span onClick={() => updateHandlingCheckout(true)}>\n                    <Login label=\"Unlock the greatness\" successCallback={t => handleCheckout(t)} />\n                </span>\n            )}\n        </div>\n    );\n};\n\nexport default Chekout;\n\nconst CheckoutButton = styled.button<{ color: string; minWidth: number }>`\n    display: block;\n    margin: auto;\n    border-style: none;\n    border: 2px solid ${props => props.color};\n    background-color: transparent;\n    color: ${props => props.color};\n    border-radius: 5px;\n    padding: 5px;\n    min-width: ${props => props.minWidth}px;\n    &:hover {\n        background-color: ${props => props.color};\n        color: black;\n    }\n`;\n"]},"metadata":{},"sourceType":"module"}