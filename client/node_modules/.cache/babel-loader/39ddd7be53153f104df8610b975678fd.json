{"ast":null,"code":"export var createPermissionState = function createPermissionState(emitNotSupportedError, window, wrapSubscribeFunction) {\n  return function (permissionDescriptor) {\n    return wrapSubscribeFunction(function (observer) {\n      if (window === null || window.navigator === undefined || window.navigator.permissions === undefined || window.navigator.permissions.query === undefined) {\n        return emitNotSupportedError(observer);\n      }\n\n      var isActive = true;\n\n      var unsubscribe = function unsubscribe() {\n        isActive = false;\n      };\n\n      window.navigator.permissions.query(permissionDescriptor).then(function (permissionStatus) {\n        if (isActive) {\n          observer.next(permissionStatus.state);\n        }\n\n        if (isActive) {\n          permissionStatus.onchange = function () {\n            return observer.next(permissionStatus.state);\n          };\n\n          unsubscribe = function unsubscribe() {\n            permissionStatus.onchange = null;\n          };\n        }\n      }, function (err) {\n        if (isActive) {\n          observer.error(err);\n        }\n      });\n      return function () {\n        return unsubscribe();\n      };\n    });\n  };\n};","map":{"version":3,"sources":["../../../src/factories/permission-state.ts"],"names":[],"mappings":"AAEA,OAAO,IAAM,qBAAqB,GAA4B,SAAjD,qBAAiD,CAAC,qBAAD,EAAwB,MAAxB,EAAgC,qBAAhC,EAAyD;AACnH,SAAO,UAAC,oBAAD;AAAA,WACH,qBAAqB,CAAC,UAAC,QAAD,EAAa;AAC/B,UACI,MAAM,KAAK,IAAX,IACA,MAAM,CAAC,SAAP,KAAqB,SADrB,IAEA,MAAM,CAAC,SAAP,CAAiB,WAAjB,KAAiC,SAFjC,IAGA,MAAM,CAAC,SAAP,CAAiB,WAAjB,CAA6B,KAA7B,KAAuC,SAJ3C,EAKE;AACE,eAAO,qBAAqB,CAAC,QAAD,CAA5B;AACH;;AAED,UAAI,QAAQ,GAAG,IAAf;;AACA,UAAI,WAAW,GAAG,uBAAK;AACnB,QAAA,QAAQ,GAAG,KAAX;AACH,OAFD;;AAIA,MAAA,MAAM,CAAC,SAAP,CAAiB,WAAjB,CAA6B,KAA7B,CAAmC,oBAAnC,EAAyD,IAAzD,CACI,UAAC,gBAAD,EAAqB;AACjB,YAAI,QAAJ,EAAc;AACV,UAAA,QAAQ,CAAC,IAAT,CAAc,gBAAgB,CAAC,KAA/B;AACH;;AAED,YAAI,QAAJ,EAAc;AACV,UAAA,gBAAgB,CAAC,QAAjB,GAA4B;AAAA,mBAAM,QAAQ,CAAC,IAAT,CAAc,gBAAgB,CAAC,KAA/B,CAAN;AAAA,WAA5B;;AAEA,UAAA,WAAW,GAAG,uBAAK;AACf,YAAA,gBAAgB,CAAC,QAAjB,GAA4B,IAA5B;AACH,WAFD;AAGH;AACJ,OAbL,EAcI,UAAC,GAAD,EAAQ;AACJ,YAAI,QAAJ,EAAc;AACV,UAAA,QAAQ,CAAC,KAAT,CAAe,GAAf;AACH;AACJ,OAlBL;AAqBA,aAAO;AAAA,eAAM,WAAW,EAAjB;AAAA,OAAP;AACH,KArCoB,CADlB;AAAA,GAAP;AAuCH,CAxCM","sourceRoot":"","sourcesContent":["export const createPermissionState = (emitNotSupportedError, window, wrapSubscribeFunction) => {\n    return (permissionDescriptor) => wrapSubscribeFunction((observer) => {\n        if (window === null ||\n            window.navigator === undefined ||\n            window.navigator.permissions === undefined ||\n            window.navigator.permissions.query === undefined) {\n            return emitNotSupportedError(observer);\n        }\n        let isActive = true;\n        let unsubscribe = () => {\n            isActive = false;\n        };\n        window.navigator.permissions.query(permissionDescriptor).then((permissionStatus) => {\n            if (isActive) {\n                observer.next(permissionStatus.state);\n            }\n            if (isActive) {\n                permissionStatus.onchange = () => observer.next(permissionStatus.state);\n                unsubscribe = () => {\n                    permissionStatus.onchange = null;\n                };\n            }\n        }, (err) => {\n            if (isActive) {\n                observer.error(err);\n            }\n        });\n        return () => unsubscribe();\n    });\n};\n//# sourceMappingURL=permission-state.js.map"]},"metadata":{},"sourceType":"module"}