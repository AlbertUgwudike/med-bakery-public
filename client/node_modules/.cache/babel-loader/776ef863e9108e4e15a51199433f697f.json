{"ast":null,"code":"export var createPermissionState = function createPermissionState(emitNotSupportedError, window, wrapSubscribeFunction) {\n  return function (permissionDescriptor) {\n    return wrapSubscribeFunction(function (observer) {\n      if (window === null || window.navigator === undefined || window.navigator.permissions === undefined || window.navigator.permissions.query === undefined) {\n        return emitNotSupportedError(observer);\n      }\n\n      var isActive = true;\n\n      var unsubscribe = function unsubscribe() {\n        isActive = false;\n      };\n\n      window.navigator.permissions.query(permissionDescriptor).then(function (permissionStatus) {\n        if (isActive) {\n          observer.next(permissionStatus.state);\n        }\n\n        if (isActive) {\n          permissionStatus.onchange = function () {\n            return observer.next(permissionStatus.state);\n          };\n\n          unsubscribe = function unsubscribe() {\n            permissionStatus.onchange = null;\n          };\n        }\n      }, function (err) {\n        if (isActive) {\n          observer.error(err);\n        }\n      });\n      return function () {\n        return unsubscribe();\n      };\n    });\n  };\n};","map":null,"metadata":{},"sourceType":"module"}