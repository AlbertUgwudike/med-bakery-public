{"ast":null,"code":"import _regeneratorRuntime from \"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\n\nvar _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { useState, useLayoutEffect } from \"react\";\nimport { OAuth2Client } from \"google-auth-library\";\nexport var updateCategory = function updateCategory(root, path, value) {\n  if (path.length === 0) {\n    return _objectSpread(_objectSpread({}, root), {}, {\n      selected: value,\n      subcategories: root.subcategories.map(falsifyCategorySelection)\n    });\n  }\n\n  var nextCategoryIdx = root.subcategories.findIndex(function (sc) {\n    return sc.categoryTitle === path[0];\n  });\n  return _objectSpread(_objectSpread({}, root), {}, {\n    selected: false,\n    subcategories: root.subcategories.map(function (sc, idx) {\n      return idx === nextCategoryIdx ? updateCategory(sc, path.slice(1), value) : sc;\n    })\n  });\n};\nexport var falsifyCategorySelection = function falsifyCategorySelection(category) {\n  return _objectSpread(_objectSpread({}, category), {}, {\n    selected: false,\n    subcategories: category.subcategories.map(falsifyCategorySelection)\n  });\n};\nexport var getAllPaths = function getAllPaths(root) {\n  if (root.subcategories.length === 0) return [[root.categoryTitle]];\n  return root.subcategories.reduce(function (categoryList, category) {\n    return categoryList.concat(getAllPaths(category).map(function (p) {\n      return [root.categoryTitle].concat(p);\n    }));\n  }, []);\n};\nexport var getPaths = function getPaths(root) {\n  if (root.selected) return getAllPaths(root);\n  if (root.subcategories.length === 0) return root.selected ? [[root.categoryTitle]] : [];\n  return root.subcategories.reduce(function (categoryList, category) {\n    return categoryList.concat(getPaths(category).map(function (p) {\n      return [root.categoryTitle].concat(p);\n    }));\n  }, []);\n};\nexport var useToken = function useToken() {\n  _s();\n\n  var getToken = function getToken() {\n    var token = sessionStorage.getItem(\"token\");\n    return token ? token : \"\";\n  };\n\n  var _useState = useState(getToken()),\n      _useState2 = _slicedToArray(_useState, 2),\n      token = _useState2[0],\n      setToken = _useState2[1];\n\n  var saveToken = function saveToken(userToken) {\n    sessionStorage.setItem(\"token\", userToken);\n    setToken(userToken);\n  };\n\n  return {\n    token: token,\n    setToken: saveToken\n  };\n}; // --------------------------------------------------------------------------------------\n\n_s(useToken, \"YxmPjHzwYO/ewBTUGNAd/YBNtug=\");\n\nexport var handleLogOut = function handleLogOut(setToken) {\n  setToken(\"\");\n  window.location.href = \"/\";\n};\nexport var getEmailFromToken = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(tokenId) {\n    var client, ticket;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            client = new OAuth2Client(process.env.GOOGlE_CLIENT_ID);\n            _context.next = 3;\n            return client.verifyIdToken({\n              idToken: tokenId,\n              audience: process.env.GOOGlE_CLIENT_ID\n            }).catch(console.log);\n\n          case 3:\n            ticket = _context.sent;\n\n            if (ticket) {\n              _context.next = 6;\n              break;\n            }\n\n            return _context.abrupt(\"return\", \"\");\n\n          case 6:\n            return _context.abrupt(\"return\", ticket.getPayload().email);\n\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function getEmailFromToken(_x) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var useWindowSize = function useWindowSize() {\n  _s2();\n\n  var _useState3 = useState([window.innerWidth, 0]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      size = _useState4[0],\n      setSize = _useState4[1];\n\n  useLayoutEffect(function () {\n    function updateSize() {\n      setSize([window.innerWidth, window.innerHeight]);\n    }\n\n    window.addEventListener(\"resize\", updateSize);\n    updateSize();\n    return function () {\n      return window.removeEventListener(\"resize\", updateSize);\n    };\n  }, []);\n  return size;\n}; // remember this, this is how we store tings in mongodb\n\n_s2(useWindowSize, \"v1jSzRwFuyLn1xxeBGMr8nW44N4=\");\n\nvar binaryToBlobUrl = function binaryToBlobUrl(byteArray, mimetype) {\n  // console.log(\"barrya\", new Uint8Array(Object.values(byteArray)));\n  var blob = new Blob([new Uint8Array(Object.values(byteArray))], {\n    type: mimetype\n  });\n  return window.URL.createObjectURL(blob);\n}; // const convertBlobsToLinks = (stn: Station<Uint8Array>): Station => {\n//     return {\n//         ...stn,\n//         questions: stn.questions.map(q => ({\n//             ...q,\n//             questionAudio: binaryToBlobUrl(q.questionAudio, \"audio/mpeg\"),\n//             exemplarAudio: binaryToBlobUrl(q.exemplarAudio, \"image/jpeg\"),\n//             img: binaryToBlobUrl(q.img, \"audio/mpeg\"),\n//             responseAudio: \"\",\n//         })),\n//     };\n// };\n\n\nexport var produceHeat = function produceHeat(n) {\n  console.time(\"producing heat\");\n  var result = 0;\n\n  for (var i = Math.pow(n, 7); i >= 0; i--) {\n    result += Math.atan(i) * Math.tan(i);\n  }\n\n  console.timeEnd(\"producing heat\");\n};","map":{"version":3,"sources":["/Users/albert/projects/med-bakery-react/client/src/functions.tsx"],"names":["useState","useLayoutEffect","OAuth2Client","updateCategory","root","path","value","length","selected","subcategories","map","falsifyCategorySelection","nextCategoryIdx","findIndex","sc","categoryTitle","idx","slice","category","getAllPaths","reduce","categoryList","concat","p","getPaths","useToken","getToken","token","sessionStorage","getItem","setToken","saveToken","userToken","setItem","handleLogOut","window","location","href","getEmailFromToken","tokenId","client","process","env","GOOGlE_CLIENT_ID","verifyIdToken","idToken","audience","catch","console","log","ticket","getPayload","email","useWindowSize","innerWidth","size","setSize","updateSize","innerHeight","addEventListener","removeEventListener","binaryToBlobUrl","byteArray","mimetype","blob","Blob","Uint8Array","Object","values","type","URL","createObjectURL","produceHeat","n","time","result","i","Math","pow","atan","tan","timeEnd"],"mappings":"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","sourcesContent":["import { MasterCategory } from \"./types\";\nimport { useState, useLayoutEffect } from \"react\";\nimport { OAuth2Client } from \"google-auth-library\";\nimport { Station } from \"./components/OSCEPage/types\";\nimport { GoogleLoginResponse } from \"react-google-login\";\n\nexport const updateCategory = (\n    root: MasterCategory,\n    path: string[],\n    value: boolean\n): MasterCategory => {\n    if (path.length === 0) {\n        return {\n            ...root,\n            selected: value,\n            subcategories: root.subcategories.map(falsifyCategorySelection),\n        };\n    }\n\n    const nextCategoryIdx = root.subcategories.findIndex(sc => sc.categoryTitle === path[0])!;\n\n    return {\n        ...root,\n        selected: false,\n        subcategories: root.subcategories.map((sc, idx) =>\n            idx === nextCategoryIdx ? updateCategory(sc, path.slice(1), value) : sc\n        ),\n    };\n};\n\nexport const falsifyCategorySelection = (category: MasterCategory): MasterCategory => {\n    return {\n        ...category,\n        selected: false,\n        subcategories: category.subcategories.map(falsifyCategorySelection),\n    };\n};\n\nexport const getAllPaths = (root: MasterCategory): string[][] => {\n    if (root.subcategories.length === 0) return [[root.categoryTitle]];\n\n    return root.subcategories.reduce((categoryList, category) => {\n        return categoryList.concat(getAllPaths(category).map(p => [root.categoryTitle].concat(p)));\n    }, [] as string[][]);\n};\n\nexport const getPaths = (root: MasterCategory): string[][] => {\n    if (root.selected) return getAllPaths(root);\n\n    if (root.subcategories.length === 0) return root.selected ? [[root.categoryTitle]] : [];\n\n    return root.subcategories.reduce((categoryList, category) => {\n        return categoryList.concat(getPaths(category).map(p => [root.categoryTitle].concat(p)));\n    }, [] as string[][]);\n};\n\nexport const useToken = () => {\n    const getToken = () => {\n        const token = sessionStorage.getItem(\"token\");\n        return token ? token : \"\";\n    };\n\n    const [token, setToken] = useState(getToken());\n\n    const saveToken: (userToken: string) => void = userToken => {\n        sessionStorage.setItem(\"token\", userToken);\n        setToken(userToken);\n    };\n\n    return { token, setToken: saveToken };\n};\n\n// --------------------------------------------------------------------------------------\n\nexport const handleLogOut = (setToken: (userToken: string) => void) => {\n    setToken(\"\");\n    window.location.href = \"/\";\n};\n\nexport const getEmailFromToken = async (tokenId: string) => {\n    const client = new OAuth2Client(process.env.GOOGlE_CLIENT_ID);\n    const ticket = await client\n        .verifyIdToken({\n            idToken: tokenId,\n            audience: process.env.GOOGlE_CLIENT_ID,\n        })\n        .catch(console.log);\n\n    if (!ticket) return \"\";\n\n    return ticket!.getPayload()!.email;\n};\n\nexport const useWindowSize = () => {\n    const [size, setSize] = useState([window.innerWidth, 0]);\n\n    useLayoutEffect(() => {\n        function updateSize() {\n            setSize([window.innerWidth, window.innerHeight]);\n        }\n\n        window.addEventListener(\"resize\", updateSize);\n        updateSize();\n\n        return () => window.removeEventListener(\"resize\", updateSize);\n    }, []);\n\n    return size;\n};\n\n// remember this, this is how we store tings in mongodb\nconst binaryToBlobUrl = (byteArray: Uint8Array, mimetype: string) => {\n    // console.log(\"barrya\", new Uint8Array(Object.values(byteArray)));\n    const blob = new Blob([new Uint8Array(Object.values(byteArray))], { type: mimetype });\n    return window.URL.createObjectURL(blob);\n};\n\n// const convertBlobsToLinks = (stn: Station<Uint8Array>): Station => {\n//     return {\n//         ...stn,\n//         questions: stn.questions.map(q => ({\n//             ...q,\n//             questionAudio: binaryToBlobUrl(q.questionAudio, \"audio/mpeg\"),\n//             exemplarAudio: binaryToBlobUrl(q.exemplarAudio, \"image/jpeg\"),\n//             img: binaryToBlobUrl(q.img, \"audio/mpeg\"),\n//             responseAudio: \"\",\n//         })),\n//     };\n// };\n\nexport const produceHeat = (n: number) => {\n    console.time(\"producing heat\");\n    let result = 0;\n    for (var i = Math.pow(n, 7); i >= 0; i--) {\n        result += Math.atan(i) * Math.tan(i);\n    }\n    console.timeEnd(\"producing heat\");\n};\n"]},"metadata":{},"sourceType":"module"}