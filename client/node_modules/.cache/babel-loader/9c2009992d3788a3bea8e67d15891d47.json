{"ast":null,"code":"import _taggedTemplateLiteral from \"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nimport _regeneratorRuntime from \"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"/Users/albert/projects/med-bakery-react/client/src/components/SubscribePage/Checkout.tsx\",\n    _this = this,\n    _s = $RefreshSig$(),\n    _templateObject;\n\nimport axios from \"axios\";\nimport { useContext, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport MetaContext from \"../../MetaContext\";\nimport { Login } from \"../HomePage/LoginLogout\";\nimport LoadingScreen from \"../OSCEPage/LoadingScreen\";\nimport heart from \"../OSCEPage/media/heart.png\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar Chekout = function Chekout(props) {\n  _s();\n\n  var _useContext = useContext(MetaContext),\n      SERVER_URL = _useContext.SERVER_URL,\n      CLIENT_URL = _useContext.CLIENT_URL,\n      token = _useContext.token;\n\n  var history = useHistory();\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      handlingCheckout = _useState2[0],\n      updateHandlingCheckout = _useState2[1];\n\n  var handleCheckout = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(t) {\n      var purchasedOsce, checkoutUrl;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              updateHandlingCheckout(true);\n              _context.prev = 1;\n              _context.next = 4;\n              return axios.post(SERVER_URL + \"/user/osce_details\", {\n                token: t\n              });\n\n            case 4:\n              purchasedOsce = _context.sent.data.purchasedOsce;\n\n              if (!purchasedOsce) {\n                _context.next = 7;\n                break;\n              }\n\n              return _context.abrupt(\"return\", history.push(\"/OSCE\"));\n\n            case 7:\n              _context.next = 9;\n              return axios.post(SERVER_URL + \"/pay/create-checkout-session\", {\n                cancel_url: CLIENT_URL + \"/Subscribe/PaymentCanceled\",\n                success_url: CLIENT_URL + \"/Subscribe/PaymentSuccess\",\n                token: t\n              });\n\n            case 9:\n              checkoutUrl = _context.sent.data;\n              history.push(checkoutUrl);\n              _context.next = 16;\n              break;\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](1);\n              console.log(_context.t0);\n\n            case 16:\n              updateHandlingCheckout(false);\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 13]]);\n    }));\n\n    return function handleCheckout(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return handlingCheckout ? /*#__PURE__*/_jsxDEV(LoadingScreen, {\n    message: \"Please wait\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 42,\n    columnNumber: 9\n  }, _this) : /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        margin: \"20px auto\",\n        justifyContent: \"center\",\n        alignItems: \"center\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          margin: \"10px\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: heart,\n          height: 100\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 21\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 53,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: \"25px\"\n          },\n          children: \" Unlock Premium Stations \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 21\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: \"15px\"\n          },\n          children: \" Only \\xA345 per year \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 21\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 17\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 13\n    }, _this), token ? /*#__PURE__*/_jsxDEV(CheckoutButton, {\n      color: \"#FAD000\",\n      minWidth: 300,\n      onClick: function onClick() {\n        return handleCheckout(token);\n      },\n      children: \"Unlock the greatness\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 17\n    }, _this) : /*#__PURE__*/_jsxDEV(\"span\", {\n      onClick: function onClick() {\n        return updateHandlingCheckout(true);\n      },\n      children: /*#__PURE__*/_jsxDEV(Login, {\n        label: \"Unlock the greatness\",\n        successCallback: function successCallback(t) {\n          return handleCheckout(t);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 21\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 17\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(Chekout, \"WvWIPHbLZUh77tDOvG3CWNREWsc=\", false, function () {\n  return [useHistory];\n});\n\n_c = Chekout;\nexport default Chekout;\nvar CheckoutButton = styled.button(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n    display: block;\\n    margin: auto;\\n    border-style: none;\\n    border: 2px solid \", \";\\n    background-color: transparent;\\n    color: \", \";\\n    border-radius: 5px;\\n    padding: 5px;\\n    min-width: \", \"px;\\n    &:hover {\\n        background-color: \", \";\\n        color: black;\\n    }\\n\"])), function (props) {\n  return props.color;\n}, function (props) {\n  return props.color;\n}, function (props) {\n  return props.minWidth;\n}, function (props) {\n  return props.color;\n});\n_c2 = CheckoutButton;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Chekout\");\n$RefreshReg$(_c2, \"CheckoutButton\");","map":{"version":3,"sources":["/Users/albert/projects/med-bakery-react/client/src/components/SubscribePage/Checkout.tsx"],"names":["axios","useContext","useState","useHistory","styled","MetaContext","Login","LoadingScreen","heart","Chekout","props","SERVER_URL","CLIENT_URL","token","history","handlingCheckout","updateHandlingCheckout","handleCheckout","t","post","purchasedOsce","data","push","cancel_url","success_url","checkoutUrl","console","log","display","margin","justifyContent","alignItems","fontSize","CheckoutButton","button","color","minWidth"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport { useContext, useState } from \"react\";\nimport { Link, useHistory } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport MetaContext from \"../../MetaContext\";\nimport { Login } from \"../HomePage/LoginLogout\";\nimport LoadingScreen from \"../OSCEPage/LoadingScreen\";\nimport heart from \"../OSCEPage/media/heart.png\";\n\ntype ChekoutProps = {};\n\nconst Chekout = (props: ChekoutProps) => {\n    const { SERVER_URL, CLIENT_URL, token } = useContext(MetaContext);\n    const history = useHistory();\n    const [handlingCheckout, updateHandlingCheckout] = useState(false);\n\n    const handleCheckout = async (t: string) => {\n        updateHandlingCheckout(true);\n        try {\n            const { purchasedOsce } = (\n                await axios.post(SERVER_URL + \"/user/osce_details\", { token: t })\n            ).data;\n\n            if (purchasedOsce) return history.push(\"/OSCE\");\n\n            const checkoutUrl = (\n                await axios.post(SERVER_URL + \"/pay/create-checkout-session\", {\n                    cancel_url: CLIENT_URL + \"/Subscribe/PaymentCanceled\",\n                    success_url: CLIENT_URL + \"/Subscribe/PaymentSuccess\",\n                    token: t,\n                })\n            ).data;\n\n            history.push(checkoutUrl);\n        } catch (err) {\n            console.log(err);\n        }\n        updateHandlingCheckout(false);\n    };\n\n    return handlingCheckout ? (\n        <LoadingScreen message=\"Please wait\" />\n    ) : (\n        <div>\n            <div\n                style={{\n                    display: \"flex\",\n                    margin: \"20px auto\",\n                    justifyContent: \"center\",\n                    alignItems: \"center\",\n                }}\n            >\n                <div style={{ margin: \"10px\" }}>\n                    <img src={heart} height={100} />\n                </div>\n                <div>\n                    <div style={{ fontSize: \"25px\" }}> Unlock Premium Stations </div>\n                    <div style={{ fontSize: \"15px\" }}> Only £45 per year </div>\n                </div>\n            </div>\n            {token ? (\n                <CheckoutButton\n                    color=\"#FAD000\"\n                    minWidth={300}\n                    onClick={() => handleCheckout(token)}\n                >\n                    Unlock the greatness\n                </CheckoutButton>\n            ) : (\n                <span onClick={() => updateHandlingCheckout(true)}>\n                    <Login label=\"Unlock the greatness\" successCallback={t => handleCheckout(t)} />\n                </span>\n            )}\n        </div>\n    );\n};\n\nexport default Chekout;\n\nconst CheckoutButton = styled.button<{ color: string; minWidth: number }>`\n    display: block;\n    margin: auto;\n    border-style: none;\n    border: 2px solid ${props => props.color};\n    background-color: transparent;\n    color: ${props => props.color};\n    border-radius: 5px;\n    padding: 5px;\n    min-width: ${props => props.minWidth}px;\n    &:hover {\n        background-color: ${props => props.color};\n        color: black;\n    }\n`;\n"]},"metadata":{},"sourceType":"module"}