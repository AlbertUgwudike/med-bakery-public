{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _slicedToArray from\"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _templateObject;import{useContext,useEffect,useState}from\"react\";import{FaPause,FaPlay}from\"react-icons/fa\";import styled from\"styled-components\";import MetaContext from\"../../../MetaContext\";import{Box}from\"../Common\";import{generateWaveSurfer}from\"../hooks\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var WaveSurferReview=function WaveSurferReview(props){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),selection=_useState2[0],updateSelection=_useState2[1];var _useContext=useContext(MetaContext),narrowWindow=_useContext.narrowWindow;var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),playing=_useState4[0],updatePlaying=_useState4[1];var handleClick=function handleClick(sel){// if already selected then just toggle\nif(sel===selection)return playing?props.stopEverything():props.play();// need to stopEverything while ws exists\nprops.stopEverything();var container=document.getElementById(\"waveform\"+props.questionIdx);if(container)container.innerHTML=\"\";var audio=sel===\"response\"?props.responseAudio:props.exemplarAudio;var waveSurfer=generateWaveSurfer(\"waveform\"+props.questionIdx,audio);// potential issue if ws already loaded, dunno if this still fires in that case\nif(selection)waveSurfer.on(\"ready\",function(_){return waveSurfer.play();});// if (sel) ==> do not play on first load\nwaveSurfer.on(\"play\",function(_){return updatePlaying(true);});waveSurfer.on(\"finish\",function(_){return updatePlaying(false);});waveSurfer.on(\"pause\",function(_){return updatePlaying(false);});props.updateWaveSurfer(waveSurfer);updateSelection(sel);};// load in the user's repsonse audio at first\nuseEffect(function(){handleClick(\"response\");},[]);return/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",marginTop:\"10px\"},children:[/*#__PURE__*/_jsxs(AudioSelect,{onClick:function onClick(){return handleClick(\"response\");},narrowWindow:narrowWindow,selected:selection===\"response\",children:[selection===\"response\"&&playing?/*#__PURE__*/_jsx(FaPause,{}):/*#__PURE__*/_jsx(FaPlay,{}),\"\\xA0 You\"]}),/*#__PURE__*/_jsxs(AudioSelect,{onClick:function onClick(){return handleClick(\"exemplar\");},narrowWindow:narrowWindow,selected:selection===\"exemplar\",children:[selection===\"exemplar\"&&playing?/*#__PURE__*/_jsx(FaPause,{}):/*#__PURE__*/_jsx(FaPlay,{}),\"\\xA0 Exemplar\"]}),/*#__PURE__*/_jsx(Box,{style:{margin:\"0\",width:\"87%\",borderRadius:\"5px\",height:\"30px\"},children:/*#__PURE__*/_jsx(\"div\",{id:\"waveform\"+props.questionIdx})})]});};export default WaveSurferReview;var AudioSelect=styled.button(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    background-color: \",\";\\n    border-radius: 5px;\\n    margin-right: 5px;\\n    height: 30px;\\n    align-content: center;\\n    width: 130px;\\n    border: 1px solid #414142;\\n    color: \",\";\\n    font-size: \",\";\\n\"])),function(props){return props.selected?\"#FAD000\":\"#031B34\";},function(props){return props.selected?\"#FFFFF\":\"#FFFF\";},function(props){return props.narrowWindow?\"12px\":\"15px\";});","map":{"version":3,"sources":["/Users/albert/projects/med-bakery-react/client/src/components/OSCEPage/QuestionReview/WaveSurferReview.tsx"],"names":["useContext","useEffect","useState","FaPause","FaPlay","styled","MetaContext","Box","generateWaveSurfer","WaveSurferReview","props","selection","updateSelection","narrowWindow","playing","updatePlaying","handleClick","sel","stopEverything","play","container","document","getElementById","questionIdx","innerHTML","audio","responseAudio","exemplarAudio","waveSurfer","on","_","updateWaveSurfer","display","justifyContent","alignItems","marginTop","margin","width","borderRadius","height","AudioSelect","button","selected"],"mappings":"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","sourcesContent":["import { Dispatch, SetStateAction, useContext, useEffect, useState } from \"react\";\nimport { FaPause, FaPlay } from \"react-icons/fa\";\nimport styled from \"styled-components\";\nimport MetaContext from \"../../../MetaContext\";\nimport { Box } from \"../Common\";\nimport { generateWaveSurfer } from \"../hooks\";\n\ntype WaveSurferReviewProps = {\n    play: () => void;\n    stopEverything: () => void;\n    responseAudio: string;\n    exemplarAudio: string;\n    updateWaveSurfer: Dispatch<SetStateAction<WaveSurfer | undefined>>;\n    questionIdx: number;\n};\n\nconst WaveSurferReview = (props: WaveSurferReviewProps) => {\n    const [selection, updateSelection] = useState<\"response\" | \"exemplar\" | \"\">(\"\");\n    const { narrowWindow } = useContext(MetaContext);\n    const [playing, updatePlaying] = useState(false);\n\n    const handleClick = (sel: \"response\" | \"exemplar\"): void => {\n        // if already selected then just toggle\n        if (sel === selection) return playing ? props.stopEverything() : props.play();\n\n        // need to stopEverything while ws exists\n        props.stopEverything();\n\n        const container = document.getElementById(\"waveform\" + props.questionIdx);\n        if (container) container.innerHTML = \"\";\n\n        const audio = sel === \"response\" ? props.responseAudio : props.exemplarAudio;\n        const waveSurfer = generateWaveSurfer(\"waveform\" + props.questionIdx, audio);\n\n        // potential issue if ws already loaded, dunno if this still fires in that case\n        if (selection) waveSurfer.on(\"ready\", _ => waveSurfer.play()); // if (sel) ==> do not play on first load\n        waveSurfer.on(\"play\", _ => updatePlaying(true));\n        waveSurfer.on(\"finish\", _ => updatePlaying(false));\n        waveSurfer.on(\"pause\", _ => updatePlaying(false));\n\n        props.updateWaveSurfer(waveSurfer);\n\n        updateSelection(sel);\n    };\n\n    // load in the user's repsonse audio at first\n    useEffect(() => {\n        handleClick(\"response\");\n    }, []);\n\n    return (\n        <div\n            style={{\n                display: \"flex\",\n                justifyContent: \"space-between\",\n                alignItems: \"center\",\n                marginTop: \"10px\",\n            }}\n        >\n            <AudioSelect\n                onClick={() => handleClick(\"response\")}\n                narrowWindow={narrowWindow}\n                selected={selection === \"response\"}\n            >\n                {selection === \"response\" && playing ? <FaPause /> : <FaPlay />}\n                &nbsp; You\n            </AudioSelect>\n\n            <AudioSelect\n                onClick={() => handleClick(\"exemplar\")}\n                narrowWindow={narrowWindow}\n                selected={selection === \"exemplar\"}\n            >\n                {selection === \"exemplar\" && playing ? <FaPause /> : <FaPlay />}\n                &nbsp; Exemplar\n            </AudioSelect>\n\n            <Box style={{ margin: \"0\", width: \"87%\", borderRadius: \"5px\", height: \"30px\" }}>\n                <div id={\"waveform\" + props.questionIdx}></div>\n            </Box>\n        </div>\n    );\n};\n\nexport default WaveSurferReview;\n\nconst AudioSelect = styled.button<{ selected: boolean; narrowWindow: boolean }>`\n    background-color: ${props => (props.selected ? \"#FAD000\" : \"#031B34\")};\n    border-radius: 5px;\n    margin-right: 5px;\n    height: 30px;\n    align-content: center;\n    width: 130px;\n    border: 1px solid #414142;\n    color: ${props => (props.selected ? \"#FFFFF\" : \"#FFFF\")};\n    font-size: ${props => (props.narrowWindow ? \"12px\" : \"15px\")};\n`;\n"]},"metadata":{},"sourceType":"module"}