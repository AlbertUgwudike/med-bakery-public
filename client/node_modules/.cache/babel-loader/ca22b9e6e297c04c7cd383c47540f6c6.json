{"ast":null,"code":"import _regeneratorRuntime from\"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/Users/albert/projects/med-bakery-react/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{useState,useLayoutEffect}from\"react\";import{OAuth2Client}from\"google-auth-library\";export var updateCategory=function updateCategory(root,path,value){if(path.length===0){return _objectSpread(_objectSpread({},root),{},{selected:value,subcategories:root.subcategories.map(falsifyCategorySelection)});}var nextCategoryIdx=root.subcategories.findIndex(function(sc){return sc.categoryTitle===path[0];});return _objectSpread(_objectSpread({},root),{},{selected:false,subcategories:root.subcategories.map(function(sc,idx){return idx===nextCategoryIdx?updateCategory(sc,path.slice(1),value):sc;})});};export var falsifyCategorySelection=function falsifyCategorySelection(category){return _objectSpread(_objectSpread({},category),{},{selected:false,subcategories:category.subcategories.map(falsifyCategorySelection)});};export var getAllPaths=function getAllPaths(root){if(root.subcategories.length===0)return[[root.categoryTitle]];return root.subcategories.reduce(function(categoryList,category){return categoryList.concat(getAllPaths(category).map(function(p){return[root.categoryTitle].concat(p);}));},[]);};export var getPaths=function getPaths(root){if(root.selected)return getAllPaths(root);if(root.subcategories.length===0)return root.selected?[[root.categoryTitle]]:[];return root.subcategories.reduce(function(categoryList,category){return categoryList.concat(getPaths(category).map(function(p){return[root.categoryTitle].concat(p);}));},[]);};export var useToken=function useToken(){var getToken=function getToken(){var token=sessionStorage.getItem(\"token\");return token?token:\"\";};var _useState=useState(getToken()),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var saveToken=function saveToken(userToken){sessionStorage.setItem(\"token\",userToken);setToken(userToken);};return{token:token,setToken:saveToken};};// --------------------------------------------------------------------------------------\nexport var handleLogOut=function handleLogOut(setToken){setToken(\"\");window.location.href=\"/\";};export var getEmailFromToken=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(tokenId){var client,ticket;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:client=new OAuth2Client(process.env.GOOGlE_CLIENT_ID);_context.next=3;return client.verifyIdToken({idToken:tokenId,audience:process.env.GOOGlE_CLIENT_ID}).catch(console.log);case 3:ticket=_context.sent;if(ticket){_context.next=6;break;}return _context.abrupt(\"return\",\"\");case 6:return _context.abrupt(\"return\",ticket.getPayload().email);case 7:case\"end\":return _context.stop();}}},_callee);}));return function getEmailFromToken(_x){return _ref.apply(this,arguments);};}();export var useWindowSize=function useWindowSize(){var _useState3=useState([window.innerWidth,0]),_useState4=_slicedToArray(_useState3,2),size=_useState4[0],setSize=_useState4[1];useLayoutEffect(function(){function updateSize(){setSize([window.innerWidth,window.innerHeight]);}window.addEventListener(\"resize\",updateSize);updateSize();return function(){return window.removeEventListener(\"resize\",updateSize);};},[]);return size;};// remember this, this is how we store tings in mongodb\nvar binaryToBlobUrl=function binaryToBlobUrl(byteArray,mimetype){// console.log(\"barrya\", new Uint8Array(Object.values(byteArray)));\nvar blob=new Blob([new Uint8Array(Object.values(byteArray))],{type:mimetype});return window.URL.createObjectURL(blob);};// const convertBlobsToLinks = (stn: Station<Uint8Array>): Station => {\n//     return {\n//         ...stn,\n//         questions: stn.questions.map(q => ({\n//             ...q,\n//             questionAudio: binaryToBlobUrl(q.questionAudio, \"audio/mpeg\"),\n//             exemplarAudio: binaryToBlobUrl(q.exemplarAudio, \"image/jpeg\"),\n//             img: binaryToBlobUrl(q.img, \"audio/mpeg\"),\n//             responseAudio: \"\",\n//         })),\n//     };\n// };\nexport var produceHeat=function produceHeat(n){console.time(\"producing heat\");var result=0;for(var i=Math.pow(n,7);i>=0;i--){result+=Math.atan(i)*Math.tan(i);}console.timeEnd(\"producing heat\");};","map":{"version":3,"sources":["/Users/albert/projects/med-bakery-react/client/src/functions.tsx"],"names":["useState","useLayoutEffect","OAuth2Client","updateCategory","root","path","value","length","selected","subcategories","map","falsifyCategorySelection","nextCategoryIdx","findIndex","sc","categoryTitle","idx","slice","category","getAllPaths","reduce","categoryList","concat","p","getPaths","useToken","getToken","token","sessionStorage","getItem","setToken","saveToken","userToken","setItem","handleLogOut","window","location","href","getEmailFromToken","tokenId","client","process","env","GOOGlE_CLIENT_ID","verifyIdToken","idToken","audience","catch","console","log","ticket","getPayload","email","useWindowSize","innerWidth","size","setSize","updateSize","innerHeight","addEventListener","removeEventListener","binaryToBlobUrl","byteArray","mimetype","blob","Blob","Uint8Array","Object","values","type","URL","createObjectURL","produceHeat","n","time","result","i","Math","pow","atan","tan","timeEnd"],"mappings":"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","sourcesContent":["import { MasterCategory } from \"./types\";\nimport { useState, useLayoutEffect } from \"react\";\nimport { OAuth2Client } from \"google-auth-library\";\nimport { Station } from \"./components/OSCEPage/types\";\nimport { GoogleLoginResponse } from \"react-google-login\";\n\nexport const updateCategory = (\n    root: MasterCategory,\n    path: string[],\n    value: boolean\n): MasterCategory => {\n    if (path.length === 0) {\n        return {\n            ...root,\n            selected: value,\n            subcategories: root.subcategories.map(falsifyCategorySelection),\n        };\n    }\n\n    const nextCategoryIdx = root.subcategories.findIndex(sc => sc.categoryTitle === path[0])!;\n\n    return {\n        ...root,\n        selected: false,\n        subcategories: root.subcategories.map((sc, idx) =>\n            idx === nextCategoryIdx ? updateCategory(sc, path.slice(1), value) : sc\n        ),\n    };\n};\n\nexport const falsifyCategorySelection = (category: MasterCategory): MasterCategory => {\n    return {\n        ...category,\n        selected: false,\n        subcategories: category.subcategories.map(falsifyCategorySelection),\n    };\n};\n\nexport const getAllPaths = (root: MasterCategory): string[][] => {\n    if (root.subcategories.length === 0) return [[root.categoryTitle]];\n\n    return root.subcategories.reduce((categoryList, category) => {\n        return categoryList.concat(getAllPaths(category).map(p => [root.categoryTitle].concat(p)));\n    }, [] as string[][]);\n};\n\nexport const getPaths = (root: MasterCategory): string[][] => {\n    if (root.selected) return getAllPaths(root);\n\n    if (root.subcategories.length === 0) return root.selected ? [[root.categoryTitle]] : [];\n\n    return root.subcategories.reduce((categoryList, category) => {\n        return categoryList.concat(getPaths(category).map(p => [root.categoryTitle].concat(p)));\n    }, [] as string[][]);\n};\n\nexport const useToken = () => {\n    const getToken = () => {\n        const token = sessionStorage.getItem(\"token\");\n        return token ? token : \"\";\n    };\n\n    const [token, setToken] = useState(getToken());\n\n    const saveToken: (userToken: string) => void = userToken => {\n        sessionStorage.setItem(\"token\", userToken);\n        setToken(userToken);\n    };\n\n    return { token, setToken: saveToken };\n};\n\n// --------------------------------------------------------------------------------------\n\nexport const handleLogOut = (setToken: (userToken: string) => void) => {\n    setToken(\"\");\n    window.location.href = \"/\";\n};\n\nexport const getEmailFromToken = async (tokenId: string) => {\n    const client = new OAuth2Client(process.env.GOOGlE_CLIENT_ID);\n    const ticket = await client\n        .verifyIdToken({\n            idToken: tokenId,\n            audience: process.env.GOOGlE_CLIENT_ID,\n        })\n        .catch(console.log);\n\n    if (!ticket) return \"\";\n\n    return ticket!.getPayload()!.email;\n};\n\nexport const useWindowSize = () => {\n    const [size, setSize] = useState([window.innerWidth, 0]);\n\n    useLayoutEffect(() => {\n        function updateSize() {\n            setSize([window.innerWidth, window.innerHeight]);\n        }\n\n        window.addEventListener(\"resize\", updateSize);\n        updateSize();\n\n        return () => window.removeEventListener(\"resize\", updateSize);\n    }, []);\n\n    return size;\n};\n\n// remember this, this is how we store tings in mongodb\nconst binaryToBlobUrl = (byteArray: Uint8Array, mimetype: string) => {\n    // console.log(\"barrya\", new Uint8Array(Object.values(byteArray)));\n    const blob = new Blob([new Uint8Array(Object.values(byteArray))], { type: mimetype });\n    return window.URL.createObjectURL(blob);\n};\n\n// const convertBlobsToLinks = (stn: Station<Uint8Array>): Station => {\n//     return {\n//         ...stn,\n//         questions: stn.questions.map(q => ({\n//             ...q,\n//             questionAudio: binaryToBlobUrl(q.questionAudio, \"audio/mpeg\"),\n//             exemplarAudio: binaryToBlobUrl(q.exemplarAudio, \"image/jpeg\"),\n//             img: binaryToBlobUrl(q.img, \"audio/mpeg\"),\n//             responseAudio: \"\",\n//         })),\n//     };\n// };\n\nexport const produceHeat = (n: number) => {\n    console.time(\"producing heat\");\n    let result = 0;\n    for (var i = Math.pow(n, 7); i >= 0; i--) {\n        result += Math.atan(i) * Math.tan(i);\n    }\n    console.timeEnd(\"producing heat\");\n};\n"]},"metadata":{},"sourceType":"module"}