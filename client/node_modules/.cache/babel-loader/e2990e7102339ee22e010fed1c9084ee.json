{"ast":null,"code":"var _jsxFileName = \"/Users/albert/projects/med-bakery-react/client/src/components/OSCEPage/QuestionReviewPage.tsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport { Box, MoveOn, Container } from \"./Common\";\nimport Header from \"./Header\";\nimport { generateWaveSurfer } from \"./hooks\";\nimport MarkScheme from \"./MarkScheme\";\nimport QuestionPrompt from \"./QuestionPrompt\";\nimport TaskSectionReview from \"./TaskSectionReview\";\nimport { exemplarId, responseId, promptId } from \"./types\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initalAudioState = {\n  promptAudio: null,\n  promptPlaying: false,\n  exemplarWaveSurfer: undefined,\n  responseWaveSurfer: undefined,\n  exemplarPlaying: false,\n  responsePlaiyng: false\n};\n\nconst QuestionReviewPage = props => {\n  _s();\n\n  const [imageExpanded, updateImageExpanded] = useState(false);\n  const [audioState, updateAudioState] = useState(initalAudioState);\n  const percentage = 10 + 100 * props.questionIdx / props.station.questions.length;\n  const question = props.station.questions[props.questionIdx];\n  const pathToNext = props.questionIdx === props.station.questions.length - 1 ? \"/OSCE/Station/MarkReview\" : \"/OSCE/Station/Review\" + (props.questionIdx + 1);\n  const pathToPrev = props.questionIdx === 0 ? \"/Demo/Summary\" : \"/Demo/Review\" + (props.questionIdx - 1);\n\n  const stopAllPlayback = () => {\n    var _audioState$promptAud, _audioState$exemplarW, _audioState$responseW;\n\n    (_audioState$promptAud = audioState.promptAudio) === null || _audioState$promptAud === void 0 ? void 0 : _audioState$promptAud.pause();\n    (_audioState$exemplarW = audioState.exemplarWaveSurfer) === null || _audioState$exemplarW === void 0 ? void 0 : _audioState$exemplarW.stop();\n    (_audioState$responseW = audioState.responseWaveSurfer) === null || _audioState$responseW === void 0 ? void 0 : _audioState$responseW.stop();\n    updateAudioState(as => ({ ...as,\n      exemplarPlaying: false,\n      responsePlaiyng: false\n    }));\n  };\n\n  const play = id => {\n    var _audioState$exemplarW2, _audioState$promptAud2, _audioState$responseW2;\n\n    stopAllPlayback();\n    updateAudioState(as => ({ ...as,\n      promptPlaying: id == promptId,\n      exemplarPlaying: id === exemplarId,\n      responsePlaiyng: id === responseId\n    }));\n    if (id === exemplarId) (_audioState$exemplarW2 = audioState.exemplarWaveSurfer) === null || _audioState$exemplarW2 === void 0 ? void 0 : _audioState$exemplarW2.play();\n    if (id === promptId) (_audioState$promptAud2 = audioState.promptAudio) === null || _audioState$promptAud2 === void 0 ? void 0 : _audioState$promptAud2.play();\n    if (id === responseId) (_audioState$responseW2 = audioState.responseWaveSurfer) === null || _audioState$responseW2 === void 0 ? void 0 : _audioState$responseW2.play();\n  };\n\n  useEffect(() => {\n    [exemplarId, responseId].forEach(id => {\n      const container = document.getElementById(id);\n      if (container) container.innerHTML = \"\";\n    });\n    updateAudioState({ ...initalAudioState,\n      promptAudio: document.getElementById(promptId),\n      exemplarWaveSurfer: generateWaveSurfer(exemplarId, question.exemplarUrl, stopAllPlayback),\n      responseWaveSurfer: generateWaveSurfer(responseId, question.responseUrl, stopAllPlayback)\n    });\n  }, []); // cease playback when compnent unmounts <=== six hour bug :)\n\n  useEffect(() => stopAllPlayback, [audioState.exemplarWaveSurfer, audioState.responseWaveSurfer]);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    style: {\n      textAlign: \"center\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      timedHeader: false,\n      briefPrompt: props.station.brief.prompt,\n      percentage: percentage,\n      title: \"Station One Review\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      style: {},\n      children: [/*#__PURE__*/_jsxDEV(QuestionPrompt, {\n        question: question,\n        toggle: () => {\n          var _audioState$promptAud3;\n\n          audioState.promptPlaying ? (_audioState$promptAud3 = audioState.promptAudio) === null || _audioState$promptAud3 === void 0 ? void 0 : _audioState$promptAud3.pause() : stopAllPlayback();\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 22\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: \"center\",\n          position: \"relative\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(Img, {\n          src: question.imgsrc,\n          imageExpanded: imageExpanded,\n          onClick: () => updateImageExpanded(!imageExpanded)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: \"absolute\",\n            top: -25,\n            width: \"100%\",\n            color: \"grey\"\n          },\n          children: [\"Click to \", imageExpanded ? \"shrink\" : \"expand\", \"!\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          color: \"grey\"\n        },\n        children: \"Exemplar Answer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(TaskSectionReview, {\n        containerId: exemplarId,\n        playing: audioState.exemplarPlaying,\n        play: () => play(exemplarId),\n        stop: stopAllPlayback\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          color: \"grey\"\n        },\n        children: \"Your Answer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(TaskSectionReview, {\n        containerId: responseId,\n        playing: audioState.responsePlaiyng,\n        play: () => play(responseId),\n        stop: stopAllPlayback\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 22\n      }, this), /*#__PURE__*/_jsxDEV(MarkScheme, {\n        questionIdx: props.questionIdx,\n        markScheme: question.markScheme,\n        updateStation: props.updateStation\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\",\n          justifyContent: \"space-between\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: \"100px\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            to: pathToPrev,\n            children: /*#__PURE__*/_jsxDEV(MoveOn, {\n              children: \"Go Back\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: \"100px\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            to: pathToNext,\n            children: /*#__PURE__*/_jsxDEV(MoveOn, {\n              children: \"Move On\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 155,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 9\n  }, this);\n};\n\n_s(QuestionReviewPage, \"SM14SMInaTmE5hBQ7g49qYQRuh8=\");\n\n_c = QuestionReviewPage;\nexport default QuestionReviewPage;\nconst Img = styled.img`\n    display: block;\n    margin: auto;\n    width: ${props => props.imageExpanded ? \"100%\" : \"60%\"};\n    transition: width 0.2s;\n    &:hover {\n        cursor: pointer;\n    }\n`;\n_c2 = Img;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"QuestionReviewPage\");\n$RefreshReg$(_c2, \"Img\");","map":{"version":3,"sources":["/Users/albert/projects/med-bakery-react/client/src/components/OSCEPage/QuestionReviewPage.tsx"],"names":["useEffect","useState","Link","styled","Box","MoveOn","Container","Header","generateWaveSurfer","MarkScheme","QuestionPrompt","TaskSectionReview","exemplarId","responseId","promptId","initalAudioState","promptAudio","promptPlaying","exemplarWaveSurfer","undefined","responseWaveSurfer","exemplarPlaying","responsePlaiyng","QuestionReviewPage","props","imageExpanded","updateImageExpanded","audioState","updateAudioState","percentage","questionIdx","station","questions","length","question","pathToNext","pathToPrev","stopAllPlayback","pause","stop","as","play","id","forEach","container","document","getElementById","innerHTML","exemplarUrl","responseUrl","textAlign","brief","prompt","position","imgsrc","top","width","color","markScheme","updateStation","display","justifyContent","Img","img"],"mappings":"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","sourcesContent":["import { Dispatch, ReactElement, SetStateAction, useEffect, useRef, useState } from \"react\";\nimport { FaPause, FaPlay } from \"react-icons/fa\";\nimport { Link } from \"react-router-dom\";\nimport styled from \"styled-components\";\nimport WaveSurfer from \"wavesurfer.js\";\nimport { StartButton, Box, MoveOn, Container } from \"./Common\";\nimport Header from \"./Header\";\nimport { generateWaveSurfer, waveSurferParams } from \"./hooks\";\nimport MarkScheme from \"./MarkScheme\";\nimport QuestionPrompt from \"./QuestionPrompt\";\nimport TaskSectionReview from \"./TaskSectionReview\";\nimport TimerBar from \"./TimerBar\";\nimport { Station, Station_new, exemplarId, responseId, promptId } from \"./types\";\n\ntype QuestionReviewPageProps = {\n    station: Station_new;\n    updateStation: Dispatch<SetStateAction<Station_new>>;\n    questionIdx: number;\n}\n\ntype AudioState = {\n    promptAudio: HTMLAudioElement | null,\n    promptPlaying: boolean,\n    exemplarWaveSurfer: WaveSurfer | undefined,\n    responseWaveSurfer: WaveSurfer | undefined,\n    exemplarPlaying: boolean,\n    responsePlaiyng: boolean\n}\n\nconst initalAudioState: AudioState = {\n    promptAudio: null, promptPlaying: false,\n    exemplarWaveSurfer: undefined, responseWaveSurfer: undefined,\n    exemplarPlaying: false, responsePlaiyng: false\n}\n\nconst QuestionReviewPage = (props: QuestionReviewPageProps) => {\n\n    const [imageExpanded, updateImageExpanded] = useState(false);\n    const [audioState, updateAudioState] = useState<AudioState>(initalAudioState)\n\n    const percentage = 10 + 100 * props.questionIdx / props.station.questions.length;\n    const question = props.station.questions[props.questionIdx];\n    const pathToNext = props.questionIdx === props.station.questions.length - 1 ? \"/OSCE/Station/MarkReview\" : (\"/OSCE/Station/Review\" + (props.questionIdx + 1));\n    const pathToPrev = props.questionIdx === 0 ? \"/Demo/Summary\" : (\"/Demo/Review\" + (props.questionIdx - 1));\n\n    const stopAllPlayback = () => {\n        audioState.promptAudio?.pause();\n        audioState.exemplarWaveSurfer?.stop()\n        audioState.responseWaveSurfer?.stop();\n        updateAudioState(as => ({ ...as, exemplarPlaying: false, responsePlaiyng: false  }))\n    }\n\n    const play = (id: string) => {\n        stopAllPlayback();\n        updateAudioState(as => ({\n            ...as,\n            promptPlaying: id == promptId,\n            exemplarPlaying: id === exemplarId,\n            responsePlaiyng: id === responseId\n        }))\n\n        if (id === exemplarId) audioState.exemplarWaveSurfer?.play();\n        if (id === promptId) audioState.promptAudio?.play();\n        if (id === responseId) audioState.responseWaveSurfer?.play()\n    }\n\n    useEffect(() => {\n\n        [exemplarId, responseId].forEach(id => {\n            const container = document.getElementById(id);\n            if (container) container.innerHTML = \"\";\n        })\n\n        updateAudioState({\n            ...initalAudioState,\n            promptAudio: document.getElementById(promptId) as HTMLAudioElement, \n            exemplarWaveSurfer: generateWaveSurfer(exemplarId, question.exemplarUrl, stopAllPlayback),\n            responseWaveSurfer: generateWaveSurfer(responseId, question.responseUrl, stopAllPlayback),\n        })\n\n    }, [])\n\n    // cease playback when compnent unmounts <=== six hour bug :)\n    useEffect(() => stopAllPlayback, [audioState.exemplarWaveSurfer, audioState.responseWaveSurfer])\n\n    return (\n        <Container style = {{ textAlign: \"center\" }}>\n\n            <Header\n                timedHeader = { false }\n                briefPrompt = { props.station.brief.prompt }\n                percentage = { percentage }\n                title = { \"Station One Review\" }\n            />\n\n            <br></br>\n\n            <Box style = {{ }}>\n\n                <QuestionPrompt \n                    question = { question }  \n                    toggle = { () => { audioState.promptPlaying ? audioState.promptAudio?.pause() : stopAllPlayback() } } \n                />\n\n                <br/><br/>\n\n                <div style = {{ textAlign: \"center\", position: \"relative\" }}>\n\n                    <Img src = { question.imgsrc } imageExpanded = { imageExpanded } onClick = { () => updateImageExpanded(!imageExpanded) } ></Img>\n                    \n                    <div style = {{ position: \"absolute\", top: -25, width: \"100%\", color: \"grey\" }}>\n                        Click to { imageExpanded ? \"shrink\" : \"expand\" }!\n                    </div>\n\n                </div>\n\n                <br/>\n\n                <div style = {{ color: \"grey\" }}>Exemplar Answer</div>\n\n                <TaskSectionReview\n                    containerId = { exemplarId }\n                    playing = { audioState.exemplarPlaying }\n                    play = { () => play(exemplarId) }\n                    stop = { stopAllPlayback }\n                />\n\n                <br/>\n\n                <div style = {{ color: \"grey\" }}>Your Answer</div>\n\n                <TaskSectionReview\n                    containerId = { responseId }\n                    playing = { audioState.responsePlaiyng }\n                    play = { () => play(responseId) }\n                    stop = { stopAllPlayback }\n                />\n                \n                <br/><br/>\n\n                <MarkScheme questionIdx = { props.questionIdx } markScheme = { question.markScheme } updateStation = { props.updateStation } />\n\n                <br/>\n\n                <div style = {{ display: \"flex\", justifyContent: \"space-between\" }}>\n\n                    <div style = {{ width: \"100px\" }}>\n                        <Link to = { pathToPrev }>\n                            <MoveOn>Go Back</MoveOn>\n                        </Link>\n                    </div>\n                    \n                    <div style = {{ width: \"100px\" }}>\n                        <Link to = { pathToNext }>\n                            <MoveOn>Move On</MoveOn>\n                        </Link>\n                    </div>\n\n                </div>\n\n            </Box>\n\n        </Container>\n    )\n\n}\n\nexport default QuestionReviewPage;\n\nconst Img = styled.img<{ imageExpanded: boolean }>`\n    display: block;\n    margin: auto;\n    width: ${ props => props.imageExpanded ? \"100%\" : \"60%\" };\n    transition: width 0.2s;\n    &:hover {\n        cursor: pointer;\n    }\n`"]},"metadata":{},"sourceType":"module"}